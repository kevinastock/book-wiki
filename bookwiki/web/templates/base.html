<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}FanWiki{% endblock %} - Development Server</title>
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü§ñ</text></svg>" />
  <link rel="stylesheet" href="{{ url_for('static', filename='pico.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='pico.colors.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='custom.css') }}">
  {% block head %}{% endblock %}
</head>

<body>
  <header>
    <nav class="container">
      <ul>
        <li><strong><a href="/">FanWiki Dev</a></strong></li>
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
        <li>
          <details class="dropdown" open>
            <summary role="button">Messages</summary>
            <ul>
              {% for category, message in messages %}
              <li>
                <span
                  class="{{ { 'warning': 'pico-color-amber-200' , 'success': 'pico-color-green-500' , 'error' : 'pico-color-red-500' }.get(category, '') }}">
                  {{ message }}
                </span>
              </li>
              {% endfor %}
            </ul>
          </details>
        </li>
        {% endif %}
        {% endwith %}
      </ul>
      {% macro nav_item(href, endpoint_prefix, label) -%}
      {% set is_current = request.endpoint and request.endpoint.startswith(endpoint_prefix) %}
      <li>
        <a href="{{ href }}" {% if is_current %} aria-current="page" {% endif %}>{{ label }}</a>
      </li>
      {%- endmacro %}

      <ul>
        {{ nav_item(url_for('chapters.list_chapters'), 'chapters.', 'Chapters') }}
        {{ nav_item('/conversations', 'conversations.', 'Conversations') }}
        {{ nav_item(url_for('wiki.wiki_redirect'), 'wiki.', 'Wiki') }}
        {{ nav_item('/prompts', 'prompts.', 'Prompts') }}
        {{ nav_item('/feedback', 'feedback.', 'Feedback') }}
        {{ nav_item(url_for('config.index'), 'config.', 'Config') }}
        <li>
          <span class="no-underline {{ { 'initialized': 'pico-color-amber-200' , 'running': 'pico-color-green-500'
            , 'paused' : 'pico-color-amber-200' , 'complete' : 'pico-color-blue-500' , 'dead' : 'pico-color-red-500'
            }.get(bg_worker_status_value, 'pico-color-grey-950' ) }}"
            data-tooltip="Status: {{ bg_worker_status_value|title }}" data-placement="bottom">‚óè</span>
        </li>
      </ul>
    </nav>
  </header>

  <main class="container">
    {% block content %}{% endblock %}
  </main>

  <footer class="container" style="text-align: center">
    <small>FanWiki Development Server</small>
  </footer>

  <script src="{{ url_for('static', filename='custom.js') }}"></script>
</body>

</html>